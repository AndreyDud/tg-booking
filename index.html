<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Запись на встречу</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 2rem; max-width: 500px; margin: auto; }
    h1 { color: #2b6cb0; }
    label { display: block; margin-top: 1rem; }
    input, select, button {
      width: 100%; padding: 0.5rem; margin-top: 0.5rem;
      border-radius: 5px; border: 1px solid #ccc;
    }
    button { background-color: #2b6cb0; color: white; font-weight: bold; cursor: pointer; margin-top: 1.5rem; }
  </style>
</head>
<body>
  <h1>Запись</h1>
  <form id="bookingForm">
    <label>Дата:
      <select id="dateSelect" required></select>
    </label>
    <label>Время:
      <select id="timeSelect" required></select>
    </label>
    <label>Имя и Фамилия:
      <input type="text" id="nameInput" required />
    </label>
    <label>Telegram Username:
      <input type="text" id="tgInput" required />
    </label>
    <button type="submit">Записаться</button>
  </form>
  <script>
    // Пример свободных слотов
    const availableSlots = {
      "2025-08-04": ["10:00", "11:00", "14:00"],
      "2025-08-05": ["09:30", "13:00", "15:00"],
      "2025-08-05": ["10:30", "13:00", "15:00"]
    };

    const dateSelect = document.getElementById("dateSelect");
    const timeSelect = document.getElementById("timeSelect");

    for (const date in availableSlots) {
      const option = document.createElement("option");
      option.value = date;
      option.textContent = new Date(date).toLocaleDateString("ru-RU");
      dateSelect.appendChild(option);
    }

    function updateTimes() {
      timeSelect.innerHTML = "";
      const selectedDate = dateSelect.value;
      availableSlots[selectedDate]?.forEach(time => {
        const opt = document.createElement("option");
        opt.value = time;
        opt.textContent = time;
        timeSelect.appendChild(opt);
      });
    }

    dateSelect.addEventListener("change", updateTimes);
    dateSelect.value = Object.keys(availableSlots)[0];
    updateTimes();

    document.getElementById("bookingForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = {
        date: dateSelect.value,
        time: timeSelect.value,
        name: document.getElementById("nameInput").value,
        telegram: document.getElementById("tgInput").value
      };
      const res = await fetch("https://script.google.com/macros/s/AKfycbxSkO05go91mxvo-U5u9i5PMVqudP-vHACQIt1klQepMLpY8xYomrs5wzi_mPhzHQaQww/exec", {
        method: "POST",
        body: JSON.stringify(data)
      });
      if (res.ok) {
        alert("Вы записались!");
      } else {
        alert("Ошибка при записи.");
      }
    });
  </script>
</body>
</html>